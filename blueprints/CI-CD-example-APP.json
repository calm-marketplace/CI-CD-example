{"status":{},"spec":{"description":"","resources":{"client_attrs":{"81806549_deployment":{"y":299.6817928305,"x":1031.2049003729},"MongoDB":{"y":300,"x":820},"81806549_deployment_cloned_1":{"y":298.7501394322,"x":1194.2480479491}},"service_definition_list":[{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MongoDB"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"51f62aff_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"7e18269a_runbook","main_task_local_reference":{"kind":"app_task","name":"51f62aff_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MongoDB"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"56d18f54_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"be9306d1_runbook","main_task_local_reference":{"kind":"app_task","name":"56d18f54_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MongoDB"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"2100c504_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"4232ffa2_runbook","main_task_local_reference":{"kind":"app_task","name":"2100c504_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MongoDB"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"765cb492_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"52f708c0_runbook","main_task_local_reference":{"kind":"app_task","name":"765cb492_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MongoDB"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"5849c5ed_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"d73ec962_runbook","main_task_local_reference":{"kind":"app_task","name":"5849c5ed_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[],"name":"MongoDB","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"NODEJS"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"1f0c21fb_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"5f2fc08c_runbook","main_task_local_reference":{"kind":"app_task","name":"1f0c21fb_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"NODEJS"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"1dd669b7_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"25261799_runbook","main_task_local_reference":{"kind":"app_task","name":"1dd669b7_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"NODEJS"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"dd79fe68_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"223767fc_runbook","main_task_local_reference":{"kind":"app_task","name":"dd79fe68_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"NODEJS"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"441f867f_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"dfef4282_runbook","main_task_local_reference":{"kind":"app_task","name":"441f867f_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"NODEJS"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"d4e61c26_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"3fbdf785_runbook","main_task_local_reference":{"kind":"app_task","name":"d4e61c26_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[],"name":"NODEJS","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"NGINX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"1f0c21fb_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"5f2fc08c_runbook_cloned_1","main_task_local_reference":{"kind":"app_task","name":"1f0c21fb_dag_cloned_1"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"NGINX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"1dd669b7_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"25261799_runbook_cloned_1","main_task_local_reference":{"kind":"app_task","name":"1dd669b7_dag_cloned_1"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"NGINX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"dd79fe68_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"223767fc_runbook_cloned_1","main_task_local_reference":{"kind":"app_task","name":"dd79fe68_dag_cloned_1"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"NGINX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"441f867f_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"dfef4282_runbook_cloned_1","main_task_local_reference":{"kind":"app_task","name":"441f867f_dag_cloned_1"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"NGINX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"d4e61c26_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"3fbdf785_runbook_cloned_1","main_task_local_reference":{"kind":"app_task","name":"d4e61c26_dag_cloned_1"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[],"name":"NGINX","port_list":[],"tier":"","variable_list":[],"description":""}],"substrate_definition_list":[{"description":"","action_list":[],"type":"AHV_VM","name":"MongoDBVM","readiness_probe":{"connection_type":"SSH","disable_readiness_probe":false,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"0","connection_port":22,"login_credential_local_reference":{"kind":"app_credential","name":"centos"}},"editables":{"create_spec":{"resources":{"nic_list":{},"serial_port_list":{},"disk_list":{}}}},"os_type":"Linux","create_spec":{"name":"-@@{calm_array_index}@@-@@{calm_time}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"33c97f77-2afd-4331-a2cc-542934091a48"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":2,"gpu_list":[],"memory_size_mib":4096,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\noutput: {all: '| tee -a \/var\/log\/cloud-init-output.log'}\npackage_upgrade: true\nuser: centos\npassword: centos\nchpasswd: { expire: False}\nssh_pwauth: True\nusers:\n - name: centos\n   sudo: ['ALL=(ALL) NOPASSWD:ALL']\n   ssh-authorized-keys:\n     - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCle6\/np\/b7emBki+KeDJ7r3BNqdeGqewX\/ziXfD5Fv\/hbt\/dkp4zSAtH3XmfAZCC6g2vmar47D6b3VZRtC1yt71jNCgfGgvh\/rwgZ8pZPZT\/DE3FGSiAbeXhbrTTusNu3sZOqT9NQOCxevQuaqQ0uw7PN0exNykiPE5T\/L1vY+0r+ReOJOqomoFpHukCtJqr4eE1AJb4WM\/kZgLABnA7yYvEloDP5cNpP3SLbK+3nbW7rCjwaq0Swx80p8Gm8XkkRFeoXEyQr1d6Wf7PErenhU8a11wuDkEGODhBX+YrnokhL5j7wtRn2Ze1JJRZTlEyA7l2fVa7uBvK0\/WBb7phC8cvcNQ9lxh0gJlWJpO3AdshJm9uhhIOsEke7KuI6IN1qpGOzAa7xxDwVwp7BiI34PvrgP18\/hb1yPAKsiuf2PoJBn5MHCC6q1j9WWKM0O2ozojFPK\/DH80jsNLPGQb2r+cpJoXA8XAm9CkRKjU1b71f0zRG6Ku7WiOqq4BpLFbpQrFaXbWYAxzLB6HSBVeukrS7gxKeP+h5ByWr3dE0AsIb+QbPvyzfT4IGr8G4BzySQfLp4XM1RCVAOKz10JUIvP0MTwj9C8zrVUvEzHF1WMQMyHtpo\/\/BWDOWrw1xt\/xyeTZaQtPuD6Gylt9pO4TtQMBiOSW7BcfS8BxnvCPxR\/kQ== thomas@thomas-findelkind.de\nruncmd:\n - echo 'Defaults:root !requiretty' > \/etc\/sudoers.d\/888-vagrant-cloud-init-requiretty"},"type":"","sysprep":null},"power_state":"ON","type":"","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"image","type":"","name":"CentOS-7-x86_64-GenericCloud.qcow2","uuid":"914cae5e-fa90-482b-9901-2ac64d344fd3"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":102400,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":1,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[],"type":"AHV_VM","name":"NODEJSVM","readiness_probe":{"connection_type":"SSH","disable_readiness_probe":false,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","connection_port":22,"login_credential_local_reference":{"kind":"app_credential","name":"centos"}},"editables":{"create_spec":{"resources":{"nic_list":{},"serial_port_list":{},"disk_list":{}}}},"os_type":"Linux","create_spec":{"name":"-@@{calm_array_index}@@-@@{calm_time}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"33c97f77-2afd-4331-a2cc-542934091a48"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":1,"gpu_list":[],"memory_size_mib":1024,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\noutput: {all: '| tee -a \/var\/log\/cloud-init-output.log'}\npackage_upgrade: true\nuser: centos\npassword: centos\nchpasswd: { expire: False}\nssh_pwauth: True\nusers:\n - name: centos\n   sudo: ['ALL=(ALL) NOPASSWD:ALL']\n   ssh-authorized-keys:\n     - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCle6\/np\/b7emBki+KeDJ7r3BNqdeGqewX\/ziXfD5Fv\/hbt\/dkp4zSAtH3XmfAZCC6g2vmar47D6b3VZRtC1yt71jNCgfGgvh\/rwgZ8pZPZT\/DE3FGSiAbeXhbrTTusNu3sZOqT9NQOCxevQuaqQ0uw7PN0exNykiPE5T\/L1vY+0r+ReOJOqomoFpHukCtJqr4eE1AJb4WM\/kZgLABnA7yYvEloDP5cNpP3SLbK+3nbW7rCjwaq0Swx80p8Gm8XkkRFeoXEyQr1d6Wf7PErenhU8a11wuDkEGODhBX+YrnokhL5j7wtRn2Ze1JJRZTlEyA7l2fVa7uBvK0\/WBb7phC8cvcNQ9lxh0gJlWJpO3AdshJm9uhhIOsEke7KuI6IN1qpGOzAa7xxDwVwp7BiI34PvrgP18\/hb1yPAKsiuf2PoJBn5MHCC6q1j9WWKM0O2ozojFPK\/DH80jsNLPGQb2r+cpJoXA8XAm9CkRKjU1b71f0zRG6Ku7WiOqq4BpLFbpQrFaXbWYAxzLB6HSBVeukrS7gxKeP+h5ByWr3dE0AsIb+QbPvyzfT4IGr8G4BzySQfLp4XM1RCVAOKz10JUIvP0MTwj9C8zrVUvEzHF1WMQMyHtpo\/\/BWDOWrw1xt\/xyeTZaQtPuD6Gylt9pO4TtQMBiOSW7BcfS8BxnvCPxR\/kQ== thomas@thomas-findelkind.de\nruncmd:\n - echo 'Defaults:root !requiretty' > \/etc\/sudoers.d\/888-vagrant-cloud-init-requiretty"},"type":"","sysprep":null},"power_state":"ON","type":"","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"image","type":"","name":"CentOS-7-x86_64-GenericCloud.qcow2","uuid":"914cae5e-fa90-482b-9901-2ac64d344fd3"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":102400,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":1,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[],"type":"AHV_VM","name":"NGINXVM","readiness_probe":{"connection_type":"SSH","disable_readiness_probe":false,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","connection_port":22,"login_credential_local_reference":{"kind":"app_credential","name":"centos"}},"editables":{"create_spec":{"resources":{"nic_list":{},"serial_port_list":{},"disk_list":{}}}},"os_type":"Linux","create_spec":{"name":"-@@{calm_array_index}@@-@@{calm_time}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"33c97f77-2afd-4331-a2cc-542934091a48"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":1,"gpu_list":[],"memory_size_mib":1024,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\noutput: {all: '| tee -a \/var\/log\/cloud-init-output.log'}\npackage_upgrade: true\nuser: centos\npassword: centos\nchpasswd: { expire: False}\nssh_pwauth: True\nusers:\n - name: centos\n   sudo: ['ALL=(ALL) NOPASSWD:ALL']\n   ssh-authorized-keys:\n     - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCle6\/np\/b7emBki+KeDJ7r3BNqdeGqewX\/ziXfD5Fv\/hbt\/dkp4zSAtH3XmfAZCC6g2vmar47D6b3VZRtC1yt71jNCgfGgvh\/rwgZ8pZPZT\/DE3FGSiAbeXhbrTTusNu3sZOqT9NQOCxevQuaqQ0uw7PN0exNykiPE5T\/L1vY+0r+ReOJOqomoFpHukCtJqr4eE1AJb4WM\/kZgLABnA7yYvEloDP5cNpP3SLbK+3nbW7rCjwaq0Swx80p8Gm8XkkRFeoXEyQr1d6Wf7PErenhU8a11wuDkEGODhBX+YrnokhL5j7wtRn2Ze1JJRZTlEyA7l2fVa7uBvK0\/WBb7phC8cvcNQ9lxh0gJlWJpO3AdshJm9uhhIOsEke7KuI6IN1qpGOzAa7xxDwVwp7BiI34PvrgP18\/hb1yPAKsiuf2PoJBn5MHCC6q1j9WWKM0O2ozojFPK\/DH80jsNLPGQb2r+cpJoXA8XAm9CkRKjU1b71f0zRG6Ku7WiOqq4BpLFbpQrFaXbWYAxzLB6HSBVeukrS7gxKeP+h5ByWr3dE0AsIb+QbPvyzfT4IGr8G4BzySQfLp4XM1RCVAOKz10JUIvP0MTwj9C8zrVUvEzHF1WMQMyHtpo\/\/BWDOWrw1xt\/xyeTZaQtPuD6Gylt9pO4TtQMBiOSW7BcfS8BxnvCPxR\/kQ== thomas@thomas-findelkind.de\nruncmd:\n - echo 'Defaults:root !requiretty' > \/etc\/sudoers.d\/888-vagrant-cloud-init-requiretty"},"type":"","sysprep":null},"power_state":"ON","type":"","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"image","type":"","name":"CentOS-7-x86_64-GenericCloud.qcow2","uuid":"914cae5e-fa90-482b-9901-2ac64d344fd3"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":102400,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":1,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]}],"credential_definition_list":[{"username":"centos","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{}}},"name":"centos"}],"package_definition_list":[{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"MongoDB"}],"name":"InstallMongo","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"InstallMongo"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"Wait_cloudInit"},{"kind":"app_task","name":"Download"},{"kind":"app_task","name":"PrepareLocalRepos"},{"kind":"app_task","name":"Install MongoDB"}],"name":"216a3f03_dag","state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Download"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"PrepareLocalRepos"}},{"from_task_reference":{"kind":"app_task","name":"PrepareLocalRepos"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Install MongoDB"}},{"from_task_reference":{"kind":"app_task","name":"Wait_cloudInit"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Download"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MongoDB"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Wait_cloudInit","state":"ACTIVE","attrs":{"exit_status":[],"script":"# Wait until cloud-init finished\nwhile [ ! -f \/var\/lib\/cloud\/instance\/boot-finished ]\ndo\n  sleep 1\ndone\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"centos"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MongoDB"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Download","state":"ACTIVE","attrs":{"exit_status":[],"script":"#mount smb share\nsudo mkdir \/mnt\/birth\necho '\/\/192.168.178.98\/iso \/mnt\/birth\tcifs\tusername=tfindelk,password=Timspw1c!' | sudo tee -a \/etc\/fstab\nsudo mount -a\n\n# Alternative insert CD\n\n\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"centos"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MongoDB"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"PrepareLocalRepos","state":"ACTIVE","attrs":{"exit_status":[],"script":"# Get rid off old repos \nsudo mkdir \/etc\/yum.repos.d\/old\nsudo mv \/etc\/yum.repos.d\/*.repo \/etc\/yum.repos.d\/old\n\n# Create repos from birth directory\n\n# Centos 7 Base repos (base,updates,extra,centosplus)\necho '\n# CentOS-Base.repo\n#\n# The mirror system uses the connecting IP address of the client and the\n# update status of each mirror to pick mirrors that are updated to and\n# geographically close to the client.  You should use this for CentOS updates\n# unless you are manually picking other mirrors.\n#\n# If the mirrorlist= does not work for you, as a fall back you can try the \n# remarked out baseurl= line instead.\n#\n#\n\n[base]\nname=CentOS-$releasever - Base\nbaseurl=file:\/\/\/mnt\/birth\/devops\/CI-CD-example\/repos\/base\ngpgcheck=1\ngpgkey=file:\/\/\/etc\/pki\/rpm-gpg\/RPM-GPG-KEY-CentOS-7\n\n#released updates \n[updates]\nname=CentOS-$releasever - Updates\nbaseurl=file:\/\/\/mnt\/birth\/devops\/CI-CD-example\/repos\/updates\ngpgcheck=1\ngpgkey=file:\/\/\/etc\/pki\/rpm-gpg\/RPM-GPG-KEY-CentOS-7\n\n#additional packages that may be useful\n[extras]\nname=CentOS-$releasever - Extras\nbaseurl=file:\/\/\/mnt\/birth\/devops\/CI-CD-example\/repos\/extras\ngpgcheck=1\ngpgkey=file:\/\/\/etc\/pki\/rpm-gpg\/RPM-GPG-KEY-CentOS-7\n\n#additional packages that extend functionality of existing packages\n[centosplus]\nname=CentOS-$releasever - Plus\nbaseurl=file:\/\/\/mnt\/birth\/devops\/CI-CD-example\/repos\/centosplus\ngpgcheck=1\nenabled=1\ngpgkey=file:\/\/\/etc\/pki\/rpm-gpg\/RPM-GPG-KEY-CentOS-7' | sudo tee -a \/etc\/yum.repos.d\/CentOS-Base.repo\n\n# MongoDB repos\necho '\n[mongodb-org-3.4]\nname=MongoDB Repository\nbaseurl=file:\/\/\/mnt\/birth\/devops\/CI-CD-example\/repos\/mongodb-org-3.4\/RPMS\ngpgcheck=0\nenabled=1\ngpgkey=https:\/\/www.mongodb.org\/static\/pgp\/server-3.4.asc' | sudo tee -a \/etc\/yum.repos.d\/mongodb-org.repo\n\n# make sure cache is updated\nsudo yum makecache","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"centos"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MongoDB"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Install MongoDB","state":"ACTIVE","attrs":{"exit_status":[],"script":"# Install mongodb\nsudo yum install -y mongodb-org\n\n# Start MongoDB\nsudo systemctl start mongod\n\n# Make sure mongodb service starts with system\nsudo systemctl enable mongod","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"centos"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"ad2fba6e_runbook","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"216a3f03_dag"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"InstallMongo"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"eee9d4dc_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"2ba18f34_runbook","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"eee9d4dc_dag"},"message_list":[],"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"NODEJS"}],"name":"InstallNodeJS","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"InstallNodeJS"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"Wait_CloudInit"},{"kind":"app_task","name":"Birth_CIFS"},{"kind":"app_task","name":"PrepareLocalRepos"},{"kind":"app_task","name":"Install NodeJS"}],"name":"34b8808c_dag","state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Wait_CloudInit"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Birth_CIFS"}},{"from_task_reference":{"kind":"app_task","name":"Birth_CIFS"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"PrepareLocalRepos"}},{"from_task_reference":{"kind":"app_task","name":"PrepareLocalRepos"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Install NodeJS"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"NODEJS"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Wait_CloudInit","state":"ACTIVE","attrs":{"exit_status":[],"script":"# Wait until cloud-init finished\nwhile [ ! -f \/var\/lib\/cloud\/instance\/boot-finished ]\ndo\n  sleep 1\ndone\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"centos"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"NODEJS"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Birth_CIFS","state":"ACTIVE","attrs":{"script":"#mount smb share\nsudo mkdir \/mnt\/birth\necho '\/\/192.168.178.98\/iso \/mnt\/birth\tcifs\tusername=tfindelk,password=Timspw1c!' | sudo tee -a \/etc\/fstab\nsudo mount -a\n\n# Alternative insert CD\n\n\n","type":"","command_line_args":"","exit_status":[],"script_type":"sh"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"NODEJS"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"PrepareLocalRepos","state":"ACTIVE","attrs":{"exit_status":[],"script":"# Get rid off old repos \nsudo mkdir \/etc\/yum.repos.d\/old\nsudo mv \/etc\/yum.repos.d\/*.repo \/etc\/yum.repos.d\/old\n\n# Create repos from birth directory\n\n# Centos 7 Base repos (base,updates,extra,centosplus)\necho '\n# CentOS-Base.repo\n#\n# The mirror system uses the connecting IP address of the client and the\n# update status of each mirror to pick mirrors that are updated to and\n# geographically close to the client.  You should use this for CentOS updates\n# unless you are manually picking other mirrors.\n#\n# If the mirrorlist= does not work for you, as a fall back you can try the \n# remarked out baseurl= line instead.\n#\n#\n\n[base]\nname=CentOS-$releasever - Base\nbaseurl=file:\/\/\/mnt\/birth\/devops\/CI-CD-example\/repos\/base\ngpgcheck=1\ngpgkey=file:\/\/\/etc\/pki\/rpm-gpg\/RPM-GPG-KEY-CentOS-7\n\n#released updates \n[updates]\nname=CentOS-$releasever - Updates\nbaseurl=file:\/\/\/mnt\/birth\/devops\/CI-CD-example\/repos\/updates\ngpgcheck=1\ngpgkey=file:\/\/\/etc\/pki\/rpm-gpg\/RPM-GPG-KEY-CentOS-7\n\n#additional packages that may be useful\n[extras]\nname=CentOS-$releasever - Extras\nbaseurl=file:\/\/\/mnt\/birth\/devops\/CI-CD-example\/repos\/extras\ngpgcheck=1\ngpgkey=file:\/\/\/etc\/pki\/rpm-gpg\/RPM-GPG-KEY-CentOS-7\n\n#additional packages that extend functionality of existing packages\n[centosplus]\nname=CentOS-$releasever - Plus\nbaseurl=file:\/\/\/mnt\/birth\/devops\/CI-CD-example\/repos\/centosplus\ngpgcheck=1\nenabled=1\ngpgkey=file:\/\/\/etc\/pki\/rpm-gpg\/RPM-GPG-KEY-CentOS-7\n\n[epel]\nname=Extra Packages for Enterprise Linux 7 - $basearch\nbaseurl=file:\/\/\/mnt\/birth\/devops\/CI-CD-example\/repos\/epel\nfailovermethod=priority\nenabled=1\ngpgcheck=0\ngpgkey=file:\/\/\/etc\/pki\/rpm-gpg\/RPM-GPG-KEY-EPEL-7' | sudo tee -a \/etc\/yum.repos.d\/CentOS-Base.repo\n\n# make sure cache is updated\nsudo yum makecache","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"centos"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"NODEJS"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Install NodeJS","state":"ACTIVE","attrs":{"exit_status":[],"script":"# Install nodejs\nsudo yum install -y nodejs","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"centos"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"374cd1e3_runbook","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"34b8808c_dag"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"InstallNodeJS"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"533b05b3_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"94d3d93d_runbook","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"533b05b3_dag"},"message_list":[],"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"NGINX"}],"name":"InstallNGINX","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"InstallNGINX"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"Wait_CloudInit"},{"kind":"app_task","name":"Birth_CIFS"},{"kind":"app_task","name":"PrepareLocalRepos"},{"kind":"app_task","name":"Install NGINX"}],"name":"34b8808c_dag_cloned_1","state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Wait_CloudInit"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Birth_CIFS"}},{"from_task_reference":{"kind":"app_task","name":"Birth_CIFS"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"PrepareLocalRepos"}},{"from_task_reference":{"kind":"app_task","name":"PrepareLocalRepos"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Install NGINX"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"NGINX"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Wait_CloudInit","state":"ACTIVE","attrs":{"exit_status":[],"script":"# Wait until cloud-init finished\nwhile [ ! -f \/var\/lib\/cloud\/instance\/boot-finished ]\ndo\n  sleep 1\ndone\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"centos"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"NGINX"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Birth_CIFS","state":"ACTIVE","attrs":{"script":"#mount smb share\nsudo mkdir \/mnt\/birth\necho '\/\/192.168.178.98\/iso \/mnt\/birth\tcifs\tusername=tfindelk,password=Timspw1c!' | sudo tee -a \/etc\/fstab\nsudo mount -a\n\n# Alternative insert CD\n\n\n","type":"","command_line_args":"","exit_status":[],"script_type":"sh"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"NGINX"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"PrepareLocalRepos","state":"ACTIVE","attrs":{"exit_status":[],"script":"# Get rid off old repos \nsudo mkdir \/etc\/yum.repos.d\/old\nsudo mv \/etc\/yum.repos.d\/*.repo \/etc\/yum.repos.d\/old\n\n# Create repos from birth directory\n\n# Centos 7 Base repos (base,updates,extra,centosplus)\necho '\n# CentOS-Base.repo\n#\n# The mirror system uses the connecting IP address of the client and the\n# update status of each mirror to pick mirrors that are updated to and\n# geographically close to the client.  You should use this for CentOS updates\n# unless you are manually picking other mirrors.\n#\n# If the mirrorlist= does not work for you, as a fall back you can try the \n# remarked out baseurl= line instead.\n#\n#\n\n[base]\nname=CentOS-$releasever - Base\nbaseurl=file:\/\/\/mnt\/birth\/devops\/CI-CD-example\/repos\/base\ngpgcheck=1\ngpgkey=file:\/\/\/etc\/pki\/rpm-gpg\/RPM-GPG-KEY-CentOS-7\n\n#released updates \n[updates]\nname=CentOS-$releasever - Updates\nbaseurl=file:\/\/\/mnt\/birth\/devops\/CI-CD-example\/repos\/updates\ngpgcheck=1\ngpgkey=file:\/\/\/etc\/pki\/rpm-gpg\/RPM-GPG-KEY-CentOS-7\n\n#additional packages that may be useful\n[extras]\nname=CentOS-$releasever - Extras\nbaseurl=file:\/\/\/mnt\/birth\/devops\/CI-CD-example\/repos\/extras\ngpgcheck=1\ngpgkey=file:\/\/\/etc\/pki\/rpm-gpg\/RPM-GPG-KEY-CentOS-7\n\n#additional packages that extend functionality of existing packages\n[centosplus]\nname=CentOS-$releasever - Plus\nbaseurl=file:\/\/\/mnt\/birth\/devops\/CI-CD-example\/repos\/centosplus\ngpgcheck=1\nenabled=1\ngpgkey=file:\/\/\/etc\/pki\/rpm-gpg\/RPM-GPG-KEY-CentOS-7\n\n[epel]\nname=Extra Packages for Enterprise Linux 7 - $basearch\nbaseurl=file:\/\/\/mnt\/birth\/devops\/CI-CD-example\/repos\/epel\nfailovermethod=priority\nenabled=1\ngpgcheck=0\ngpgkey=file:\/\/\/etc\/pki\/rpm-gpg\/RPM-GPG-KEY-EPEL-7' | sudo tee -a \/etc\/yum.repos.d\/CentOS-Base.repo\n\n# make sure cache is updated\nsudo yum makecache","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"centos"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"NGINX"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Install NGINX","state":"ACTIVE","attrs":{"exit_status":[],"script":"# Install nginx\nsudo yum install -y nginx","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"centos"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"374cd1e3_runbook_cloned_1","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"34b8808c_dag_cloned_1"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"InstallNGINX"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"533b05b3_dag_cloned_1","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"94d3d93d_runbook_cloned_1","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"533b05b3_dag_cloned_1"},"message_list":[],"variable_list":[]}},"variable_list":[]}],"app_profile_list":[{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"depends_on_list":[],"name":"06e2991f_deployment","published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"InstallMongo"}],"substrate_local_reference":{"kind":"app_substrate","name":"MongoDBVM"},"min_replicas":"1","variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"depends_on_list":[],"name":"81806549_deployment","published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"InstallNodeJS"}],"substrate_local_reference":{"kind":"app_substrate","name":"NODEJSVM"},"min_replicas":"1","variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"depends_on_list":[],"name":"81806549_deployment_cloned_1","published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"InstallNGINX"}],"substrate_local_reference":{"kind":"app_substrate","name":"NGINXVM"},"min_replicas":"1","variable_list":[],"description":""}],"description":"","action_list":[],"name":"Default","variable_list":[]}],"published_service_definition_list":[],"default_credential_local_reference":{"kind":"app_credential","name":"centos"},"type":"USER"},"name":"CI-CD-example-APP"},"api_version":"3.0","metadata":{"last_update_time":"1539251561782540","kind":"blueprint","spec_version":16,"creation_time":"1538395129200178","name":"CI-CD-example-APP"}}